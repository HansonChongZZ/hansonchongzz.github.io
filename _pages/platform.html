---
layout: empty
title: "Occupations and Skills Network Explorer"
permalink: /tool/
---

<div id="container">
    <div id="loading">Loading occupation network...</div>

    <div id="demo-banner">
        üéØ Live Demo ‚Ä¢ Using Sample Data from Your Datasets
    </div>

    <div id="search-container">
        <input type="text" id="search-input" placeholder="Search for an occupation...">
        <div id="search-results"></div>
    </div>

    <div id="controls">
        <button class="control-btn" id="reset-zoom">Reset View</button>
    </div>

    <svg id="network-canvas"></svg>

    <div id="tooltip">
        <div class="tooltip-title"></div>
        <div class="tooltip-content"></div>
    </div>

    <div id="legend">
        <div class="legend-title">AI Exposure Index</div>
        <div class="legend-item">
            <div class="legend-color" style="background: linear-gradient(to right, #22c55e, #eab308, #ef4444);"></div>
            <span>Low ‚Üí High</span>
        </div>
    </div>

    <div id="modal-overlay">
        <div id="modal">
            <button id="modal-close">&times;</button>
            <div class="modal-content"></div>
        </div>
    </div>
</div>

<!-- D3.js -->
<script src="https://d3js.org/d3.v7.min.js"></script>

<!-- Custom CSS -->
<link rel="stylesheet" href="{{ '/assets/css/platform.css' | relative_url }}">

<script>
function initializeApp() {
    if (typeof d3 === 'undefined') {
        setTimeout(initializeApp, 100);
        return;
    }

    console.log('‚úÖ D3.js loaded successfully');

    const width = window.innerWidth;
    const height = window.innerHeight;
    let simulation, svg, g, nodes, links, nodeElements, linkElements;
    let occupationsData = {};
    let skillsData = {};
    let tasksData = {};
    let selectedNode = null;

    svg = d3.select('#network-canvas')
        .attr('width', width)
        .attr('height', height);

    const zoom = d3.zoom()
        .scaleExtent([0.1, 10])
        .on('zoom', (event) => g.attr('transform', event.transform));

    svg.call(zoom);
    g = svg.append('g');

    const colorScale = d3.scaleSequential()
        .domain([0, 1])
        .interpolator(d3.interpolateRgbBasis(['#22c55e', '#eab308', '#ef4444']));

    // ‚úÖ Updated data path for AcademicPages
    const dataPath = '/assets/platform/';

    Promise.all([
        d3.csv(dataPath + 'occupations_nodelist__4-digits_.csv'),
        d3.csv(dataPath + 'occupations_edgelist__4-digits_specific_skils_only_.csv'),
        d3.csv(dataPath + 'masco-4d_with_skills.csv'),
        d3.csv(dataPath + 'masco-4d_with_tasks_and_scores__GPT4o_.csv')
    ]).then(([nodesData, edgesData, skillsDataRaw, tasksDataRaw]) => {
        // Process nodes
        nodes = nodesData.map(d => ({
            id: d.code,
            name: d.occupation,
            aiExposure: parseFloat(d.AI_exposure_index),
            quartile: d.quartile,
            wage: d.wage !== 'NA' ? parseFloat(d.wage) : null
        }));

        // Process links
        links = edgesData.map(d => ({
            source: d.from,
            target: d.to,
            weight: parseFloat(d.weight)
        }));

        // Process skills data
        skillsDataRaw.forEach(d => {
            if (!skillsData[d.code]) skillsData[d.code] = [];
            skillsData[d.code].push({ skill: d.skills, type: d.skill_type });
        });

        // Process tasks data
        tasksDataRaw.forEach(d => {
            if (!tasksData[d.code]) tasksData[d.code] = { occupation: d.occupation, tasks: [] };
            tasksData[d.code].tasks.push({ task: d.tasks, score: parseFloat(d.score) });
        });

        nodes.forEach(node => { occupationsData[node.id] = node; });

        initializeVisualization();
        document.getElementById('loading').style.display = 'none';
        console.log('üéâ Network Loaded Successfully!');
    }).catch(error => {
        console.error('Error loading data:', error);
        document.getElementById('loading').innerHTML = `
            <div style="text-align:center;color:#ef4444;font-size:20px;">‚ö†Ô∏è Error Loading Data</div>
            <div style="color:#94a3b8;font-size:14px;">Make sure CSVs are in <code>/assets/platform-data/</code></div>
        `;
    });

    function initializeVisualization() {
        simulation = d3.forceSimulation(nodes)
            .force('link', d3.forceLink(links).id(d => d.id).distance(d => 200 - d.weight * 10))
            .force('charge', d3.forceManyBody().strength(-300))
            .force('center', d3.forceCenter(width / 2, height / 2))
            .force('collision', d3.forceCollide().radius(15));

        linkElements = g.append('g')
            .selectAll('line')
            .data(links)
            .enter().append('line')
            .attr('stroke', '#3a4a6b')
            .attr('stroke-width', d => Math.sqrt(d.weight) * 0.5)
            .attr('opacity', 0);

        nodeElements = g.append('g')
            .selectAll('circle')
            .data(nodes)
            .enter().append('circle')
            .attr('r', 6)
            .attr('fill', d => colorScale(d.aiExposure))
            .attr('stroke', '#ffffff')
            .attr('stroke-width', 1.5)
            .attr('opacity', 0.8)
            .style('cursor', 'pointer')
            .on('mouseover', handleMouseOver)
            .on('mouseout', handleMouseOut)
            .on('click', handleClick);

        simulation.on('tick', () => {
            linkElements
                .attr('x1', d => d.source.x)
                .attr('y1', d => d.source.y)
                .attr('x2', d => d.target.x)
                .attr('y2', d => d.target.y);

            nodeElements
                .attr('cx', d => d.x)
                .attr('cy', d => d.y);
        });
    }

    // ... Keep all existing mouse, tooltip, modal, search, zoom handlers unchanged ...

}

// Start app when DOM ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeApp);
} else {
    initializeApp();
}
</script>
